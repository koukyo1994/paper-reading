# A Linear Non-Gaussian Acyclic Model for Causal Discovery

## Basic Information

### 引用情報
Shimizu, Shohei, et al. "A linear non-Gaussian acyclic model for causal discovery." Journal of Machine Learning Research 7.Oct (2006): 2003-2030.

### リンク
http://www.jmlr.org/papers/volume7/shimizu06a/shimizu06a.pdf

### Citation
725

## どんなもの?

(a) 線形, (b) 未観測共通原因がない, (c) 誤差項は非ゼロの分散を持った非ガウシアンな分布になる、の三つの仮定を置くことで連続値データから因果グラフを発見する手法、LiNGAMの提案をした論文。信号処理の手法ICA(Independent Component Analysis)を用いており、変数間の時間的順序を定義する必要がないのが特徴。

## 先行研究と比べてどこがすごい?

多くの先行研究は線形ガウシアンの仮定を置いていたが、これはいくつかの可能な解を提示するに止まっていた。この論文では線形"非"ガウシアンの仮定を置くことで完全な因果グラフをデータのみから復元出来ることを示した。

## 技術屋手法のキモはどこ?

以下の仮定を置く
* 観測変数の間には因果的順序を定義できる。これは変数がdirected acyclic graph(DAG)で表現できることと同じ意味である。
* 変数間の関係が線形和 + 誤差項 + 定数項で表される
* 誤差項は非ガウシアンであり互いに独立である

```{latex}
x_i = \sum_{k(j) < k(i)} b_{ij}x_j + e_i + c_i
```

このモデルをLiNGAM(Linear Non-Gaussian Acyclic Model)と呼ぶ。このモデルから生成されたデータベクトル`X`があるとする。ここでのキモは誤差項が"非"ガウシアンである、という仮定である。

多くの先行研究は誤差項がガウシアンであるという仮定を置いていた。これは、変数の同時分布を簡単に計算でき、分散共分散行列が全ての情報を持っているため条件付き独立をベースとした因果発見アルゴリズムが簡単に適用できるという利点があったが、情報を捨ててしまっているという欠点があった。

構造方程式

```{latex}
\mathbf{x} = \mathbf{Bx} + \mathbf{e}
```

があったとき因果的順序を知っていれば下三角行列に直すことができ

```{latex}
\mathbf{x} = \mathbf{Ae}
```

と変形できる。これに対してICAをかけることで`A`を推定できる。ただし`A = (I-B)^{-1}`である。

以下、LiNGAMの発見アルゴリズム

1. m x nデータ行列(m << n>)があるとする。各カラムが一つのデータベクトルに対応するとする。まず、**各行から平均を引いておき**、ICAを適用して`X = AS`となるような圧縮を得る。ただし、`S`は`X`と同じサイズであり、各行が独立成分である。`W = A^{-1}`とする。
2. `W`の各行を入れ替えて対角がゼロにならないようにする。
3. `W`の対角要素が1になるように適当な変換を施す。
4. `B = I - W`に従い`B`をえる。
5. 厳密な下三角行列`B'`ができるような変換`B' = PBP^T`を得る。

行列の行の入れ替えや枝刈りなどで細かい議論が他にもある。

## どうやって有効だと検証した?

人工データと時系列データで検証。以下、時系列データについて

時系列のLiNGAMはAR(自己回帰)モデル

```{latex}
X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \cdots + \phi_p X_{t-p} + a_p
```

のようになるはず。定常なARをLiNGAMを用いて求めるのがこの実験。LiNGAMは多変量でないとできないため、時間窓を用いて切りそれぞれを変数とした。

22のデータセットを選び、LiNGAMを適用してみた。大雑把に分けると経済系のデータセットと環境系のデータセット。
データの生成プロセスが定常のARであり、non-Gaussianの仮定にしたがっていれば因果的順序を見つけられる可能性が高いが、経済系のデータに多い**ランダムウォークでは時間的順序を決められないため、正しい向きと逆向きの両方がありうる。** **変数が実は因果関係にない場合、あらゆる因果の向きがもっともらしく出てしまうことがある。** その他、

* 生成プロセスが非線形
* 誤差が実はGaussian
* 未観測共通原因が存在

などの場合には失敗するかも。

結果として

1. 5例について正しい因果的順序が見つかった
2. 9例について逆の因果的順序が見つかった
3. 1例について`B`行列がゼロ行列として得られた
4. 7例について因果的順序が明確に定まらなかった

## 議論はある?

実データでの検証が重要

## 次に読むべき論文は?

LiNGAM: Non-Gaussian methods for estimating causal structures
Shohei Shimizu
http://www.ar.sanken.osaka-u.ac.jp/~sshimizu/papers/Shimizu13BHMK.pdf
